---
title: '626'
author: "Nicholas Ray"
date: "1/26/2023"
output: pdf_document
---
```{r Libraries, message=FALSE, warning=FALSE}
library(here); library(tidyverse)
```
```{r Data, message=FALSE, warning=FALSE}
cmp<-read_csv(here("CMP.zip"))
```
```{r Cleaning}
cmp<-cmp %>%
  mutate(date=gsub('../../','',edate),date=as.numeric(date)) %>%
  select(-country,-oecdmember,-eumember,-edate,-party,-partyabbrev,-coderid,-manual,-coderyear,-testresult,-testeditsim,-voteest,-presvote,-progtype,-datasetorigin,-corpusversion,-total,-peruncod)
#per109:internationalism_negative,per406:protectionism_positive,per608:multiculturalism_negative,per601:national_...
cmp2 <- cmp %>% #building lg_anti
  filter(date>1989 & date<2021) %>%
  group_by(countryname,partyname) %>%
  summarise(anti=round(mean(per109+per608),1),vote=round(mean(pervote),1),parfam=mean(parfam)) %>%
  mutate(lg_anti=ifelse(anti>1 & vote>10,1,0),lg_anti_natpar=ifelse(anti>1 & vote>10 & parfam==70,1,0))
cmp3<-cmp2 %>% #cmp4 but with only countries with lg_anti and their party names (allows us to see what parties in cmp4)
  filter(lg_anti==1)
cmp4<-cmp2 %>% #most condensed info, possibly table for paper
  group_by(countryname) %>%
  summarise(lg_anti=sum(lg_anti),lg_anti_natpar=sum(lg_anti_natpar))
```

May be able to argue that if `lg_anti` is 0, then incumbent political system has failed to respond to anti-globalist sentiment IF it exists.

Deeper case studies: Looking at Austria, and how it's 2 "anti-globalist" parties have changed in political power over the years. Can also include graph for measure of globalization...

Really trying to look at how these two items that are supposed to measure anti-globalization politics (per109, per608) changes over time, along with how an objective measure of globalization has changed over time. Then want to see if "incumbents" responded to globalization or if others did. Austria is a great example, where it seems that the Austrian Freedom Party championed anti-globalist issues after already being prominent in the parliament. Hence, this incumbent system adapted to, or even tried to appease the losers of, globalization. 

```{r Graphs}
graph<-function(country,party){
  title<-c(country, party)
  cmp %>%
  filter(countryname==country,partyname==party) %>%
  ggplot(aes(x=date)) +
    geom_line(aes(y=(per109+per608),color="anti")) +
    geom_line(aes(y=(pervote),color="vote")) +
    labs(title = paste0(c(title), collapse = ", "))
}
graph('Austria','Austrian Freedom Party')
```